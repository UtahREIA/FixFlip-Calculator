<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Property Listing</title>
<style>
    body { font-family: 'Segoe UI', sans-serif; background: #f2f2f7; margin: 0; padding: 30px; }
    .center { text-align: center; }
    .btn-main { background: #0066cc; color: #fff; padding: 14px 25px; border: none; border-radius: 6px; cursor: pointer; font-size: 18px; }
    .btn-main:hover { background: #004c99; }

    .form-container { max-width: 650px; margin: 25px auto; background: #fff; padding: 25px; border-radius: 10px; display: none; }
    input, textarea { width: 100%; padding: 12px; margin: 8px 0; border-radius: 6px; border: 1px solid #ccc; font-size: 15px; }
    .cards { margin-top: 30px; display: grid; grid-template-columns: repeat(auto-fit, minmax(260px, 1fr)); gap: 25px; }
    .card { background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 2px 8px rgba(0,0,0,0.15); cursor: pointer; transition: .25s; width: 260px; height: 260px; }
    .card:hover { transform: scale(1.03); }
    .card img { width: 100%; height: 150px; object-fit: cover; }
    .card-body { padding: 12px; }
    .price { color: #028a0f; font-weight: bold; margin: 5px 0; }

    /* Modal */
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); justify-content: center; align-items: center; }
    .modal-content { background: #fff; width: 90%; max-width: 650px; border-radius: 12px; overflow: hidden; }
    .modal img { width: 100%; height: 300px; object-fit: cover; }
    .modal-body { padding: 20px; }
    .close { float: right; font-size: 24px; cursor: pointer; }
</style>
</head>
<body>

<div class="center">
    <button class="btn-main" onclick="toggleForm()">âž• Add a Property</button>
</div>

<div class="form-container" id="propertyForm">
    <h2>Add Property Details</h2>
    <input type="text" id="title" placeholder="Property Title">
    <input type="text" id="location" placeholder="Location">

    <!-- PRICE INPUT WITH AUTO-COMMAS -->
    <input type="text" id="price" placeholder="Price (USD)" oninput="formatPrice(this)">

    <textarea id="description" placeholder="Description"></textarea>
    <input type="file" id="imageUpload" accept="image/*">

    <h3>Agent / Member Contact Info</h3>
    <input type="text" id="agentName" placeholder="Full Name">
    <input type="text" id="agentPhone" placeholder="Phone / WhatsApp">
    <input type="email" id="agentEmail" placeholder="Email (optional)">

    <button class="btn-main" onclick="saveProperty()">Save Property</button>
</div>

<div class="cards" id="cardsArea"></div>

<!-- Modal Preview -->
<div class="modal" id="modal">
  <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <img id="modalImg">
      <div class="modal-body">
          <h2 id="modalTitle"></h2>
          <p id="modalLocation"></p>
          <p class="price" id="modalPrice"></p>
          <p id="modalDescription"></p>
          <hr>
          <h3>Contact the Agent</h3>
          <p id="modalAgentName"></p>
          <p id="modalAgentPhone"></p>
          <p id="modalAgentEmail"></p>
      </div>
  </div>
</div>

<script>
function toggleForm() {
    const form = document.getElementById("propertyForm");
    form.style.display = form.style.display === "block" ? "none" : "block";
}

let properties = [];

// auto comma price formatting while typing
function formatPrice(input) {
    let value = input.value.replace(/,/g, "");
    if (!isNaN(value)) {
        input.value = Number(value).toLocaleString("en-US");
    }
}

function saveProperty() {
    const title = document.getElementById("title").value;
    const location = document.getElementById("location").value;
    const price = document.getElementById("price").value.replace(/,/g, "");
    const description = document.getElementById("description").value;
    const image = document.getElementById("imageUpload").files[0];

    const agentName = document.getElementById("agentName").value;
    const agentPhone = document.getElementById("agentPhone").value;
    const agentEmail = document.getElementById("agentEmail").value;

    if (!title || !location || !price || !image || !agentName || !agentPhone) {
        alert("Please fill all required fields");
        return;
    }

    const reader = new FileReader();
    reader.onload = function(e) {
        const property = {
            title, location, price, description,
            img: e.target.result,
            agentName, agentPhone, agentEmail
        };
        properties.push(property);
        showCards();
    };
    reader.readAsDataURL(image);

    document.getElementById("propertyForm").reset();

    // CLOSE FORM AFTER SAVE
    document.getElementById("propertyForm").style.display = "none";
}

function showCards() {
    const cardsArea = document.getElementById("cardsArea");
    cardsArea.innerHTML = "";

    properties.forEach((p, index) => {
        const priceFormatted = Number(p.price).toLocaleString("en-US");
        cardsArea.innerHTML += `
          <div class="card" onclick="openModal(${index})">
              <img src="${p.img}">
              <div class="card-body">
                  <h4>${p.title}</h4>
                  <p>${p.location}</p>
                  <p class="price">$${priceFormatted}</p>
              </div>
          </div>
        `;
    });
}

function openModal(index) {
    const p = properties[index];
    document.getElementById("modalImg").src = p.img;
    document.getElementById("modalTitle").innerText = p.title;
    document.getElementById("modalLocation").innerText = p.location;
    document.getElementById("modalPrice").innerText = "$" + Number(p.price).toLocaleString("en-US");
    document.getElementById("modalDescription").innerText = p.description;

    document.getElementById("modalAgentName").innerText = "Name: " + p.agentName;
    document.getElementById("modalAgentPhone").innerText = "Phone: " + p.agentPhone;
    document.getElementById("modalAgentEmail").innerText = p.agentEmail ? "Email: " + p.agentEmail : "";

    document.getElementById("modal").style.display = "flex";
}

function closeModal() {
    document.getElementById("modal").style.display = "none";
}
</script>

</body>
</html>
