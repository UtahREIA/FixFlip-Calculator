<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Utah REIA Fix & Flip Calculator</title>
    <link rel="stylesheet" href="style.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="wrap" id="calcWrap">
  <div class="top"><img src="https://assets.cdn.filesafe.space/DNirEjy0ejVwbHsaBYrn/media/682f680ec314718407baed82.png" alt="Utah REIA logo"></div>
  <h1>Utah REIA Fix & Flip Calculator</h1>
  <div class="subtitle">Step-by-step analysis to estimate profit, ROI, and investment, includes itemized editing and visual summaries.</div>

  <div class="progress card">
    <div class="progress-fill" id="progressFill" style="width:0%"></div>
    <div class="step-ind" id="stepIndicator">Step 1 of 8</div>
  </div>

  <!-- Steps -->
  <div id="stepsArea">

    <!-- STEP 1: Address -->
    <div class="card step active" data-step="1">
      <div class="muted">Property Information</div>
      <div class="row">
        <div class="field"><label>Street address</label><input id="street" type="text" placeholder="Start typing address..."></div>
        <div class="field"><label>City</label><input id="city" type="text" placeholder="City"></div>
        <div class="field"><label>State</label><input id="state" type="text" placeholder="UT"></div>
        <div class="field"><label>ZIP code</label><input id="zip" type="text" placeholder="ZIP"></div>
      </div>
      <div class="field"><label>Optional: property features / description</label><textarea id="features" placeholder="3 bed / 2 bath..."></textarea></div>
    </div>

    <!-- STEP 2: Estimates -->
    <div class="card step" data-step="2">
      <div class="muted">Estimates</div>
      <div class="row">
        <div class="field"><label>After Repair Value (ARV)</label><input id="arv" type="text" inputmode="numeric" placeholder="$350,000"></div>
        <div class="field"><label>Desired Profit</label><input id="desiredProfit" type="text" inputmode="numeric" placeholder="$30,000"></div>
      </div>

      <div style="margin-top:12px">
        <label style="font-weight:600;color:var(--blue);display:block;margin-bottom:8px">How to Estimate ARV - Video</label>
        <div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;border-radius:8px;">
          <iframe src="https://www.loom.com/embed/393dcac19b484e07aaadcd6271864f4d" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%"></iframe>
        </div>
      </div>
    </div>

    <!-- STEP 3: Purchase -->
    <div class="card step" data-step="3">
      <div class="row" style="align-items:center">
        <div style="flex:1">
          <div class="muted">Purchase Costs</div>
          <div class="row">
            <div class="field"><label>Purchase Price</label><input id="purchasePrice" type="text" placeholder="$240,000"></div>
            <div class="field">
              <label>Purchase Closing (total)</label>
              <div style="display:flex;gap:8px;align-items:center">
                <input id="purchaseClosing" type="text" placeholder="$3,000">
                <button type="button" class="pencil" title="Edit breakdown" onclick="toggleEditor('purchase')">
                  âœï¸ Edit
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- purchase editor -->
      <div class="editor" id="editor-purchase" aria-hidden="true">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <strong>Itemized Purchase Closing Breakdown</strong>
          <span class="muted">Default items are editable, add rows as needed.</span>
        </div>

        <!-- default rows (expanded per request) -->
        <div class="item">
          <input class="item-label" value="Wholesaler Fee" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="750">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option><option value="pct_loan">% of Loan</option></select>
          <select class="item-loan-roll"><option value="upfront">Pay Upfront</option><option value="roll">Roll Into Loan</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Loan Points" placeholder="Label">
          <input class="item-value small-input" data-kind="pct_loan" value="1.7">
          <select class="item-kind"><option value="pct_loan">% of Loan</option><option value="fixed">$ (fixed)</option></select>
          <select class="item-loan-roll"><option value="upfront">Pay Upfront</option><option value="roll">Roll Into Loan</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Title Agent Fees" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="400">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <select class="item-loan-roll"><option value="upfront">Pay Upfront</option><option value="roll">Roll Into Loan</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Doc Prep" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="600">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <select class="item-loan-roll"><option value="upfront">Pay Upfront</option><option value="roll">Roll Into Loan</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Lender's Title Insurance" placeholder="Label">
          <input class="item-value small-input" data-kind="pct_price" value="0.2">
          <select class="item-kind"><option value="pct_price">% of Price</option><option value="fixed">$ (fixed)</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Property Insurance" placeholder="Label">
          <input class="item-value small-input" data-kind="pct_price" value="0.4">
          <select class="item-kind"><option value="pct_price">% of Price</option><option value="fixed">$ (fixed)</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Title Endorsements" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="75">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Recording Fees" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="250">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Home Inspection" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="300">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Sewer Scope" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="100">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Meth Test" placeholder="Label">
          <input class="item-value small-input" data-kind="fixed" value="100">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcPurchaseEditor()">ğŸ—‘ï¸</button>
        </div>

        <div id="purchase-add-area"></div>

        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button type="button" class="btn" onclick="addItem('purchase')">+ Add line</button>
          <div class="muted" style="margin-left:8px">Each line supports fixed or percentage (of price or loan). 'Roll Into Loan' excludes from upfront closing total.</div>
        </div>

        <div class="row-actions">
          <div class="total-display">Editor Total: <span id="purchaseEditorTotal">$0</span></div>
          <div style="display:flex;gap:8px">
            <button type="button" class="btn secondary" onclick="cancelEditor('purchase')">Cancel</button>
            <button type="button" class="btn" onclick="saveEditor('purchase')">Save</button>
          </div>
        </div>
      </div>
    </div>

    <!-- STEP 4: Rehab -->
    <div class="card step" data-step="4">
      <div class="muted">Rehab Costs</div>
      <div class="field"><label>Repair costs (total)</label><input id="repairs" type="text" placeholder="$40,000"></div>
    </div>

    <!-- STEP 5: Holding (includes Loan Type) -->
    <div class="card step" data-step="5">
      <div class="muted">Holding Costs & Financing Type</div>
      <div class="row">
        <div class="field"><label>Holding costs (monthly)</label><input id="holdingMonthly" type="text" placeholder="$1,200"></div>
        <div class="field"><label>Estimated timeframe (months)</label>
          <select id="holdingTime">
            <option value="0.5">0.5 (2 wks)</option><option value="1">1</option><option value="3">3</option>
            <option value="6">6</option><option value="9">9</option><option value="12">12</option><option value="24">24</option>
          </select>
        </div>
        <div class="field"><label>Loan Amount (for interest)</label><input id="loanAmount" type="text" placeholder="$150,000"></div>
        <div class="field"><label>Interest Rate (%)</label><input id="interestRate" type="number" value="10" min="0" step="0.1"></div>
        <div class="field"><label>Loan Type</label>
          <select id="loanType"><option>Interest-Only</option><option>Amortized</option></select>
        </div>
      </div>

      <div style="display:flex;align-items:center;gap:10px;margin-top:8px">
        <button type="button" class="pencil" onclick="toggleEditor('holding')">âœï¸ Edit Holding Items</button>
        <div class="muted" style="margin-left:auto">Add taxes, insurance, utilities, HOA, etc.</div>
      </div>

      <div class="editor" id="editor-holding" aria-hidden="true">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <strong>Holding Cost Breakdown (monthly)</strong><span class="muted">Monthly extras will be added to monthly holding.</span>
        </div>

        <div class="item">
          <input class="item-label" value="Loan Payments">
          <input class="item-value small-input" data-kind="fixed" value="1505">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcHoldingEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Property Taxes">
          <input class="item-value small-input" data-kind="fixed" value="198">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcHoldingEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Insurance">
          <input class="item-value small-input" data-kind="fixed" value="163">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcHoldingEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Utilities">
          <input class="item-value small-input" data-kind="fixed" value="225">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcHoldingEditor()">ğŸ—‘ï¸</button>
        </div>

        <div id="holding-add-area"></div>

        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button type="button" class="btn" onclick="addItem('holding')">+ Add line</button>
          <div class="muted" style="margin-left:8px">Monthly extras automatically included in holding total.</div>
        </div>

        <div class="row-actions">
          <div class="total-display">Monthly Extras: <span id="holdingEditorTotal">$0</span></div>
          <div style="display:flex;gap:8px">
            <button type="button" class="btn secondary" onclick="cancelEditor('holding')">Cancel</button>
            <button type="button" class="btn" onclick="saveEditor('holding')">Save</button>
          </div>
        </div>
      </div>

      <div style="margin-top:10px">
        <div class="small-note">Loan Interest (simple) = (Loan Ã— Interest% Ã— Months) / 12</div>
        <div style="margin-top:6px" class="muted">Interest Total: <strong id="holdingInterest">$0</strong> Holding Total (including interest): <strong id="holdingTotalDisplay">$0</strong></div>
      </div>
    </div>

    <!-- STEP 6: Sale Costs -->
    <div class="card step" data-step="6">
      <div class="muted">Sale Costs</div>
      <div class="row">
        <div class="field"><label>Agent commission (%)</label><input id="agentCommission" type="number" value="6"></div>
        <div class="field"><label>Sale closing costs</label><input id="saleClosing" type="text" placeholder="$2,000"></div>
      </div>
    </div>

    <!-- STEP 7: Financing Extras (moved here) -->
    <div class="card step" data-step="7">
      <div class="muted">Financing Extras</div>
      <div style="margin-bottom:8px">Add origination, points, appraisal, processing fees, etc. These will be included in financing extras total.</div>

      <div style="display:flex;gap:8px;flex-wrap:wrap;margin-bottom:8px">
        <button type="button" class="pencil" onclick="toggleEditor('finance')">âœï¸ Edit Financing Extras</button>
      </div>

      <div class="editor" id="editor-finance" aria-hidden="true">
        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
          <strong>Financing Extras</strong><span class="muted">Default percentages are editable.</span>
        </div>

        <div class="item">
          <input class="item-label" value="Origination Fee">
          <input class="item-value small-input" data-kind="pct_price" value="2">
          <select class="item-kind"><option value="pct_price">% of Price</option><option value="pct_loan">% of Loan</option><option value="fixed">$ (fixed)</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcFinanceEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Loan Points">
          <input class="item-value small-input" data-kind="pct_loan" value="4">
          <select class="item-kind"><option value="pct_loan">% of Loan</option><option value="fixed">$ (fixed)</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcFinanceEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Processing Fee">
          <input class="item-value small-input" data-kind="fixed" value="500">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcFinanceEditor()">ğŸ—‘ï¸</button>
        </div>

        <div class="item">
          <input class="item-label" value="Appraisal Fee">
          <input class="item-value small-input" data-kind="fixed" value="400">
          <select class="item-kind"><option value="fixed">$ (fixed)</option><option value="pct_price">% of Price</option></select>
          <button type="button" class="icon-btn" onclick="this.parentNode.remove(); recalcFinanceEditor()">ğŸ—‘ï¸</button>
        </div>

        <div id="finance-add-area"></div>

        <div style="margin-top:8px;display:flex;gap:8px;align-items:center">
          <button type="button" class="btn" onclick="addItem('finance')">+ Add line</button>
        </div>

        <div class="row-actions">
          <div class="total-display">Financing Extras: <span id="financeEditorTotal">$0</span></div>
          <div style="display:flex;gap:8px">
            <button type="button" class="btn secondary" onclick="cancelEditor('finance')">Cancel</button>
            <button type="button" class="btn" onclick="saveEditor('finance')">Save</button>
          </div>
        </div>
      </div>
    </div>

    <!-- STEP 8: Results -->
    <div class="card step" data-step="8">
      <div class="muted">Finish Analysis & Visual Summary</div>

      <div id="finalResults" style="display:none;margin-top:12px"></div>
      <div id="numericBreakdown" style="display:none;margin-top:10px"></div>

      <div class="charts" id="chartsArea" style="display:none">
        <div class="chart-card">
          <h4 style="margin:0 0 6px">Investment Breakdown</h4>
          <canvas id="chartInvest" height="260"></canvas>
        </div>
        <div class="chart-card">
          <h4 style="margin:0 0 6px">Profit vs Target</h4>
          <canvas id="chartProfit" height="260"></canvas>
        </div>
      </div>

      <div style="margin-top:12px" class="lead-box">
        <input id="leadName" type="text" placeholder="Your name" style="padding:10px;border-radius:8px;border:1px solid #eee;margin-right:8px">
        <input id="leadEmail" type="email" placeholder="Your email" style="padding:10px;border-radius:8px;border:1px solid #eee;margin-right:8px">
        <button id="sendLead" type="button" class="btn" disabled>Send My Report</button>
        <button id="downloadPDF" type="button" class="btn secondary" style="margin-left:6px">Download Report (PDF)</button>
      </div>

    </div>

  </div>

  <div class="nav">
    <button id="prevBtn" type="button" class="btn secondary">â† Back</button>
    <div style="display:flex;gap:8px;">
      <button id="nextBtn" type="button" class="btn">Next â†’</button>
    </div>
  </div>

  <div style="text-align:center;margin-top:12px;color:var(--muted);font-size:13px">Â© 2025 Utah REIA - Estimates are educational only.</div>
</div>

    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.2.0/dist/chartjs-plugin-datalabels.min.js"></script>

    <!-- html2canvas + jsPDF for PDF download -->
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

    <!-- Google Places -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBv5v5ZA_pJvv_jT_ERUuXAQbG0xBqOWRY"></script>
</body>

</html>